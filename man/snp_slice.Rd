% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/snp_slice.R
\name{snp_slice}
\alias{snp_slice}
\alias{snp_slice_categorical}
\alias{snp_slice_poisson}
\alias{snp_slice_binomial}
\alias{snp_slice_negative_binomial}
\title{Bayesian Nonparametric Resolution of Multi-Strain Infections}
\usage{
snp_slice(
  data,
  model = "negative_binomial",
  n_mcmc = 10000,
  burnin = NULL,
  alpha = 2.6,
  rho = 0.5,
  threshold = 0.001,
  gap = NULL,
  seed = NULL,
  verbose = TRUE,
  log_performance = FALSE,
  store_mcmc = FALSE,
  ...
)

snp_slice_categorical(data, e1 = 0.05, e2 = 0.05, ...)

snp_slice_poisson(data, ...)

snp_slice_binomial(data, ...)

snp_slice_negative_binomial(data, ...)
}
\arguments{
\item{data}{Input data. Can be a matrix, data.frame, or file path. For read count data,
should be a list with elements \code{read1} and \code{read0} (or \code{total}). For categorical data,
should be a matrix with values 0, 0.5, or 1.}

\item{model}{Observation model to use. Options: "categorical", "poisson", "binomial",
"negative_binomial" (default).}

\item{n_mcmc}{Number of MCMC iterations (default: 10000).}

\item{burnin}{Burn-in period. If NULL, defaults to n_mcmc/2.}

\item{alpha}{IBP concentration parameter (default: 2.6).}

\item{rho}{Dictionary sparsity parameter (default: 0.5).}

\item{threshold}{Threshold for identifying single infections (default: 0.001).}

\item{gap}{Early stopping threshold. If NULL, runs for full n_mcmc iterations.}

\item{seed}{Random seed for reproducibility.}

\item{verbose}{Whether to print progress information (default: TRUE).}

\item{store_mcmc}{Whether to store full MCMC samples (default: FALSE).}

\item{...}{Additional model-specific parameters.}

\item{e1}{Error parameter for categorical model (default: 0.05)}

\item{e2}{Error parameter for categorical model (default: 0.05)}
}
\value{
An object of class \code{snp_slice_results} containing:
\itemize{
\item \code{allocation_matrix}: Binary allocation matrix (A)
\item \code{dictionary_matrix}: Binary dictionary matrix (D)
\item \code{mcmc_samples}: MCMC samples (if store_mcmc = TRUE)
\item \code{diagnostics}: Convergence diagnostics
\item \code{parameters}: Model parameters used
\item \code{model_info}: Model specification
}
}
\description{
SNP-Slice is a Bayesian nonparametric method for resolving multi-strain infections
using slice sampling with stick-breaking construction. The algorithm simultaneously
unveils strain haplotypes and links them to hosts from sequencing data.
}
\examples{
\dontrun{
# Example with read count data
data <- list(
  read1 = matrix(c(10, 5, 15, 8), nrow = 2),
  read0 = matrix(c(90, 95, 85, 92), nrow = 2)
)

result <- snp_slice(data, model = "negative_binomial", n_mcmc = 1000)

# Extract results
strains <- extract_strains(result)
allocations <- extract_allocations(result)
}

}
